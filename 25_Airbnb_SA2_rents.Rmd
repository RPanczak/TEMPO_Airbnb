---
title: "Airbnb"
subtitle: "Monthly income on SA2 level"
author: "Radoslaw Panczak"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document: 
    highlight: pygments
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 4
    toc_float: yes
---

<!-- ------------------------------------------------------------ --> 
<!-- ------------------------------------------------------------ --> 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, 
                      fig.width=8, fig.height=6, 
                      out.width="800px", out.height="600px", 
                      dpi=300)

knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
set.seed(12345)
options(scipen = 999)

library(pacman) 
p_load(tidyverse, magrittr, lubridate, scales, readxl, janitor,
       sf, tmap, tmaptools, 
       skimr, summarytools, sjmisc, kableExtra, naniar)

tmap_mode("view") # makes map interactive
```


```{r geodata_load, include=FALSE}
# SA2
SA2 <- readRDS(file = "./data/geo/SA2_2016_AUST_clean.rds") %>% 
  filter(SA4_CODE16 != "901") %>% 
  select(-starts_with("SA3")) %>% 
  select(-starts_with("SA1")) %>% 
  select(-starts_with("GCC")) %>% 
  select(-AREASQKM16) %>% 
  mutate(STE_CODE16 = as.numeric(as.character(STE_CODE16))) %>% 
  mutate(SA2_MAIN16 = as.numeric(as.character(SA2_MAIN16))) %>% 
  mutate(SA2_5DIG16 = as.numeric(as.character(SA2_5DIG16))) %>% 
  mutate(SA4_CODE16 = as.numeric(as.character(SA4_CODE16))) %>% 
  mutate(SA4_GCC_CODE16 = case_when(
    SA4_CODE16 %in% c(402, 403, 404) ~ 401,
    SA4_CODE16 %in% c(302:305, 310, 311, 313, 314) ~ 301,
    SA4_CODE16 %in% c(207:214) ~ 206,
    SA4_CODE16 %in% c(503:507) ~ 502,
    SA4_CODE16 %in% c(115:128 ) ~ 102,
    TRUE ~ SA4_CODE16
  )
  ) %>% 
  mutate(SA4_GCC_NAME16 = case_when(
    SA4_GCC_CODE16 == 401 ~ "Greater Adelaide",
    SA4_GCC_CODE16 == 301 ~ "Greater Brisbane",
    SA4_GCC_CODE16 == 206 ~ "Greater Melbourne",
    SA4_GCC_CODE16 == 502 ~ "Greater Perth",
    SA4_GCC_CODE16 == 102 ~ "Greater Sydney",
    TRUE ~ SA4_NAME16
  )
  ) %>% 
  select(-SA4_CODE16, -SA4_NAME16)

# centroids from arcgis - with option 'inside'
SA2_centr <- st_read("./data/geo/1270055001_sa2_2016_aust_shape/SA2_2016_AUST_centr_inside.shp", stringsAsFactors = FALSE) %>% 
  filter(SA4_CODE16 != "901") %>% 
  select(-starts_with("SA3")) %>% 
  select(-starts_with("SA1")) %>% 
  select(-starts_with("GCC")) %>% 
  select(-AREASQKM16) %>% 
  mutate(STE_CODE16 = as.numeric(as.character(STE_CODE16))) %>% 
  mutate(SA2_MAIN16 = as.numeric(as.character(SA2_MAIN16))) %>% 
  mutate(SA2_5DIG16 = as.numeric(as.character(SA2_5DIG16))) %>% 
  mutate(SA4_CODE16 = as.numeric(as.character(SA4_CODE16))) %>% 
  mutate(SA4_GCC_CODE16 = case_when(
    SA4_CODE16 %in% c(402, 403, 404) ~ 401,
    SA4_CODE16 %in% c(302:305, 310, 311, 313, 314) ~ 301,
    SA4_CODE16 %in% c(207:214) ~ 206,
    SA4_CODE16 %in% c(503:507) ~ 502,
    SA4_CODE16 %in% c(115:128 ) ~ 102,
    TRUE ~ SA4_CODE16
  )
  ) %>% 
  mutate(SA4_GCC_NAME16 = case_when(
    SA4_GCC_CODE16 == 401 ~ "Greater Adelaide",
    SA4_GCC_CODE16 == 301 ~ "Greater Brisbane",
    SA4_GCC_CODE16 == 206 ~ "Greater Melbourne",
    SA4_GCC_CODE16 == 502 ~ "Greater Perth",
    SA4_GCC_CODE16 == 102 ~ "Greater Sydney",
    TRUE ~ SA4_NAME16
  )
  ) %>% 
  select(-SA4_CODE16, -SA4_NAME16)

# STATES
STE <- readRDS(file = "./data/geo/STE_2016_AUST_clean.rds") %>%  
  mutate(STE_CODE16 = as.numeric(as.character(STE_CODE16))) %>% 
  filter(STE_CODE16 != 9) 

# qtm(STE)
```

<!-- ------------------------------------------------------------ --> 
<!-- ------------------------------------------------------------ --> 

# Data preparation

Data prep focusing on monthly income generated on SA2 level. 

```{r, include=FALSE}
property_select <- readRDS("./data/airdna/clean/property_new_select.Rds") 

monthly_select <- readRDS("./data/airdna/clean/monthly_new_select.Rds") 
```

Raw datasets consist of `r comma(nrow(property_select))` properties and 
`r comma(nrow(monthly_select))` monthly stats. 

## Selection

```{r}
temp1 <- monthly_select %>% 
  filter(reporting_month < ymd("2016-01-01"))

monthly_select %<>% 
  filter(reporting_month >= ymd("2016-01-01"))

# length(unique(monthly_select$property_id)) 
# length(unique(property_select$property_id))

temp2 <- property_select %>% 
  anti_join(select(monthly_select, property_id) %>% distinct())

property_select %<>% 
  anti_join(select(temp2, property_id))
```

`r comma(nrow(temp1))` data points from before 2016-01-01 are excluded.

`r comma(nrow(temp2))` properties that haven't got any records in monthly data were excluded.

## Join

Datasets of `r comma(nrow(property_select))` properties and 
`r comma(nrow(monthly_select))` monthly stats were merged together. 

```{r, include=FALSE}
#### Other Territories
OT <- property_select %>% 
  dplyr::filter(STE_NAME16 == "Other Territories")

property_select %<>% 
  dplyr::filter(STE_NAME16 != "Other Territories")

#### zero aud - convert to usd
zero_aud <- monthly_select %>% 
  dplyr::filter(revenue_native == 0 & revenue_usd > 0)

# sjmisc::descr(zero_aud, revenue_usd)

#### missing aud - convert to usd
mis_aud <- monthly_select %>% 
  dplyr::filter(is.na(revenue_native) & !is.na(revenue_usd))

# sjmisc::descr(mis_aud, revenue_usd)

monthly_select %<>% 
  mutate(revenue_native = ifelse(test = revenue_native == 0 & revenue_usd > 0, 
                                 yes = revenue_usd*1.4, 
                                 no = revenue_native)) %>% 
  mutate(revenue_native = ifelse(test = is.na(revenue_native) & !is.na(revenue_usd), 
                                 yes = revenue_usd*1.4, 
                                 no = revenue_native)) 
```

First, data for `r format(nrow(OT), nsmall=0, big.mark=",")` properties located in Other Teritories were excluded. 

Next, `r format(nrow(zero_aud), nsmall=0, big.mark=",")` monthly records that had zero AUD income but some information in USD had income recalculated using 1.4 exchange rate.

Next, `r format(nrow(mis_aud), nsmall=0, big.mark=",")` monthly records that had missing AUD income but some information in USD had income recalculated using 1.4 exchange rate.

```{r, include=FALSE}
rm(zero_aud, mis_aud, OT, temp1, temp2)
```

## Outliers

There are few ouliers in terms of monthly income

```{r}
temp <- monthly_select %>% 
  arrange(desc(revenue_native)) %>% 
  select(property_id, reporting_month, reservation_days, 
         starts_with("Revenue"), starts_with("ADR")) %>% 
  slice(1:36)

monthly_select %>% 
  arrange(desc(revenue_native)) %>% 
  select(property_id, reporting_month, reservation_days,
         starts_with("Revenue"), starts_with("ADR")) %>% 
  slice(1:36)

# View(filter(property_select, property_id == 14999741))
# Luxury 80ft Motor Yacht - 4 Bedroom
# $6,990.00 per night

# View(filter(property_select, property_id == 30109331))
# Kalinya Estate - Homestead & Lodge -26 p
# $3,200.00 per night
```

From the top 11 monthly income values (with income above $90k) data corrected using USD values.

One very high value was replaced to average ADR * booked days from previous & next month from the same property.


```{r include=FALSE}
monthly_select %<>% 
  mutate(revenue_native = ifelse(test = revenue_native > 95000, 
                                 yes = revenue_usd*1.4, no = revenue_native))

monthly_select %<>% 
  mutate(revenue_native = ifelse(test = property_id == 10045109 & reporting_month == "2016-02-01", 
                                 yes = mean(c(45.42, 48.11))*9, no = revenue_native))

monthly_select %<>% 
  mutate(revenue_native = ifelse(test = property_id == 11287673, 
                                 yes = reservation_days*28, no = revenue_native))
```

Nine very high monthly values were recalculated from more realistic ADR (in USD) indicators.

```{r include=FALSE}
monthly_select %<>% 
  mutate(revenue_native = ifelse(test = property_id == 23709347	&
                                   reporting_month == ymd("2018-04-01"), 
                                 yes = reservation_days*adr_usd*1.4, no = revenue_native))

monthly_select %<>% 
  mutate(revenue_native = ifelse(test = property_id == 22267809	&
                                   reporting_month == ymd("2018-05-01"), 
                                 yes = reservation_days*adr_usd*1.4, no = revenue_native))

monthly_select %<>% 
  mutate(revenue_native = ifelse(test = property_id == 22536123	&
                                   reporting_month == ymd("2018-07-01"), 
                                 yes = reservation_days*adr_usd*1.4, no = revenue_native))
monthly_select %<>% 
  mutate(revenue_native = ifelse(test = property_id == 22536123	&
                                   reporting_month == ymd("2018-04-01"), 
                                 yes = reservation_days*adr_usd*1.4, no = revenue_native))

monthly_select %<>% 
  mutate(revenue_native = ifelse(test = property_id == 11926837	&
                                   reporting_month == ymd("2016-06-01"), 
                                 yes = reservation_days*adr_usd*1.4, no = revenue_native))

monthly_select %<>% 
  mutate(revenue_native = ifelse(test = property_id == 27554784	&
                                   reporting_month == ymd("2019-02-01"), 
                                 yes = reservation_days*adr_usd*1.4, no = revenue_native))


monthly_select %<>% 
  mutate(revenue_native = ifelse(test = property_id == 15206751	&
                                   reporting_month == ymd("2017-04-01"), 
                                 yes = reservation_days*adr_usd*1.4, no = revenue_native))

monthly_select %<>% 
  mutate(revenue_native = ifelse(test = property_id == 15206751	&
                                   reporting_month == ymd("2017-05-01"), 
                                 yes = reservation_days*adr_usd*1.4, no = revenue_native))

monthly_select %<>% 
  mutate(revenue_native = ifelse(test = property_id == 27554784	&
                                   reporting_month == ymd("2019-01-01"), 
                                 yes = reservation_days*adr_usd*1.4, no = revenue_native))

airbnb_new_monthly <- left_join(monthly_select, property_select)
saveRDS(airbnb_new_monthly, file = "data/airdna/clean/airbnb_new_monthly.Rds")
```


```{r include=FALSE}
rm(monthly_select, property_select)
gc()
```

Final dataset consists of `r comma(nrow(airbnb_new_monthly))`
monthly records of `r comma(length(unique(airbnb_new_monthly$property_id)))` properties. 

## SA2 areas

Locations of Airbnb properties (points) were linked to ABS data of SA2 areas from 2016. Spatial join in ArcGIS was used with `CLOSEST` option to capture locations that did not overlap with polygons (see example here  https://www.airbnb.com/rooms/19103554 - due to privacy reasons, locations are not exact). 

`r nrow(filter(SA2, !SA2_MAIN16 %in% unique(airbnb_new_monthly$SA2_MAIN16)))` SA2s (out of `r nrow(SA2)`) have no Airbnbs inside. 

```{r}
temp <- SA2 %>% 
  filter(!SA2_MAIN16 %in% unique(airbnb_new_monthly$SA2_MAIN16))

temp %>% 
  select(-SA2_MAIN16, -SA2_5DIG16, -STE_CODE16, -SA4_GCC_CODE16) %>% 
  tm_shape() +
  tm_polygons(col = "red", alpha = 0.5)
```

These areas have been excluded from analyses.

```{r include=FALSE}
SA2 %<>% 
  filter(!SA2_MAIN16 %in% temp$SA2_MAIN16)

SA2_centr %<>% 
  filter(!SA2_MAIN16 %in% temp$SA2_MAIN16)

rm(temp)
```

FInal geographical set consists of `r comma(nrow(SA2))` SA2s. 

## 'Filling' time series

Areas where no income was reported during reporting month had those months filled with 0 AUD.  

```{r, include=FALSE}
temp <- airbnb_new_monthly %>% 
  group_by(SA2_MAIN16, reporting_month) %>% 
  summarise(revenue = sum(revenue_native, na.rm = TRUE))

airbnb_sa2 <- left_join(st_drop_geometry(SA2), temp) %>% 
  expand(SA2_MAIN16, reporting_month) %>% 
  filter(!is.na(reporting_month)) %>% 
  left_join(st_drop_geometry(SA2)) %>% 
  left_join(temp) %>% 
  tidyr::replace_na(list(revenue = 0)) %>% 
  mutate(revenue = as.integer(round(revenue))) %>% 
  mutate_if(is.factor, as.character) %>% 
  ungroup() %>% 
  group_by(SA2_MAIN16) %>% arrange(reporting_month) %>% mutate(cumulative = cumsum(revenue)) %>% 
  ungroup() %>% 
  arrange(SA2_MAIN16, reporting_month)

# summarytools::freq(airbnb_sa2$reporting_month)
stopifnot(nrow(SA2) * length(unique(airbnb_new_monthly$reporting_month)) == nrow(airbnb_sa2))
```

```{r include=FALSE}
rm(temp)
gc()
```

## Prepared dataset

'Income curves' with `r nrow(airbnb_sa2)` data points of Airbnb revenue for `r nrow(SA2)` areas. 

Absolute monthly values:

```{r}
ggplot(data=airbnb_sa2, 
       aes(x=reporting_month, y=revenue/1000000, 
           color=STE_NAME16, group=SA2_MAIN16)) +
  geom_line(alpha=0.5) +
  theme_minimal() + xlab("") + ylab("Airbnb revenue [*1,000,000]$")
```

Cumulative values:

```{r}
ggplot(data=airbnb_sa2, 
       aes(x=reporting_month, y=cumulative/1000000, 
           color=STE_NAME16, group=SA2_MAIN16)) +
  geom_line(alpha=0.5) +
  theme_minimal() + xlab("") + ylab("Airbnb revenue [*1,000,000]$")
```

<!-- ------------------------------------------------------------ --> 
<!-- ------------------------------------------------------------ --> 

# Explanatory variables on SA2 level

## 

## SEIFA

```{r}
SEIFA_sa2 <- read_xls("data/ABS/SEIFA/raw/2033055001 - sa2 indexes.xls", 
                      sheet = "Table 1", skip = 5, na = "-") %>% 
  clean_names() %>%
  remove_empty(c("rows", "cols")) %>% 
  dplyr::rename(SA2_MAIN16 = `x1`, SA2_NAME16 = `x2`, 
                IRSD_s = `score_3`, IRSD_d = `decile_4`,
                IRSAD_s = `score_5`, IRSAD_d = `decile_6`, 
                IER_s = `score_7`, IER_d = `decile_8`, 
                IEO_s = `score_9`, IEO_d = `decile_10`, 
                URP = `x11`) %>% 
  dplyr::mutate(IRSD_d = as.integer(IRSD_d),
                IRSAD_d = as.integer(IRSAD_d),
                IER_d = as.integer(IER_d),
                IEO_d = as.integer(IEO_d)) %>% 
  filter(! SA2_NAME16 %in% c("Christmas Island", "Cocos (Keeling) Islands", 
                             "Jervis Bay", "Norfolk Island")) # Other Teritories


# missing all seifa
SEIFA_mis <- SA2 %>% 
  anti_join(select(SEIFA_sa2, SA2_MAIN16, URP))

# checking for airbnbs
airbnb_SEIFA_mis <- airbnb_new_monthly %>%
  filter(SA2_MAIN16 %in% unique(SEIFA_mis$SA2_MAIN16))


# missing one of seifa
SEIFA_na <- anti_join(SEIFA_sa2, select(drop_na(SEIFA_sa2), SA2_MAIN16))

SEIFA_na_sf <- SA2 %>% 
  right_join(SEIFA_na)

# checking for airbnbs
airbnb_SEIFA_na <- airbnb_new_monthly %>%
  filter(SA2_MAIN16 %in% unique(SEIFA_na$SA2_MAIN16))
```

### Areas with no SEIFA

`r nrow(SEIFA_mis)` areas, usually non-residential or with no/low pop. 

There are `r comma(nrow(airbnb_SEIFA_mis))` records of `r comma(length(unique(airbnb_SEIFA_mis$property_id)))` propoerties in these areas. 

```{r}
SEIFA_mis %>% 
  select(-SA2_MAIN16, -SA2_5DIG16, -STE_CODE16, -SA4_GCC_CODE16) %>% 
  tm_shape() +
  tm_polygons(col = "red", alpha = 0.5, lwd = 1)

# SA2 %<>% 
#   filter(!SA2_MAIN16 %in% SEIFA_mis$SA2_MAIN16)
```

### Areas without one or more indices

`r nrow(SEIFA_na)` areas, usually with small pops. **Excluded from analyses!**.

There are `r number(nrow(airbnb_SEIFA_na))` records of `r number(length(unique(airbnb_SEIFA_na$property_id)))` propoerties in these areas. 

```{r}
SEIFA_na_sf %>% 
  select(-SA2_MAIN16, -SA2_5DIG16, -STE_CODE16, -SA4_GCC_CODE16) %>% 
  tm_shape() +
  tm_polygons(col = "red", alpha = 0.5, lwd = 1)
# SA2 %<>% 
#   filter(!SA2_MAIN16 %in% SEIFA_na$SA2_MAIN16)
```

```{r include=FALSE}
rm(SEIFA_na, SEIFA_na_sf, SEIFA_mis, airbnb_SEIFA_na, airbnb_SEIFA_mis)
gc()
```


```{r}
airbnb_sa2 %<>%  left_join(select(SEIFA_sa2, SA2_MAIN16, ends_with("_d")))
```

### IRSD

Index of Relative Socio-economic Disadvantage deciles 

```{r}
SEIFA_sa2_sf <- left_join(SA2, SEIFA_sa2)
rm(SEIFA_sa2)

tm_shape(SEIFA_sa2_sf) +
  tm_polygons(col = "IRSD_d", n = 10, palette = "BrBG", alpha = 0.5, lwd = 0)
```

### IRSAD

Index of Relative Socio-economic Advantage and Disadvantage deciles

```{r}
tm_shape(SEIFA_sa2_sf) +
  tm_polygons(col = "IRSAD_d", n = 10, palette = "BrBG", alpha = 0.5, lwd = 0)
```

### IER

Index of Economic Resources deciles

```{r}
tm_shape(SEIFA_sa2_sf) +
  tm_polygons(col = "IER_d", n = 10, palette = "BrBG", alpha = 0.5, lwd = 0)
```

### IEO

Index of Education and Occupation deciles

```{r}
tm_shape(SEIFA_sa2_sf) +
  tm_polygons(col = "IEO_d", n = 10, palette = "BrBG", alpha = 0.5, lwd = 0)
```

## Distance to coast

### Binary

Binary indicator has been created for costal proximity. SA2s that touch the coast have been flagged. Note: this is very crude proxy. Doesn't work well for large areas and in the areas with river estuaries.  

```{r}
coast_bin_sa2 <- read_csv("./data/airdna/raw/Spatial_join/coast_bin_sa2.zip",
                          col_types = cols(COAST = col_integer())) %>% 
  select(SA2_MAIN16, COAST) %>% 
  rename(coast_bin = COAST)

airbnb_sa2 %<>% left_join(coast_bin_sa2)

SA2 <- left_join(SA2, coast_bin_sa2)

rm(coast_bin_sa2)
```

```{r}
filter(airbnb_sa2, reporting_month == as.Date("2017-10-01")) %>% 
  frq(coast_bin)
```

```{r}
tm_shape(SA2) +
  tm_polygons(col = "coast_bin", n = 2, alpha = 0.5, lwd = 0.5)
```

### Average distance

Alternative solution is to calculate distance to coast for all properties and then average that over area. However that leaves the areas without properties without data.

```{r}
coast_near <- read_csv("./data/airdna/raw/Spatial_join/coast_near.zip") %>% 
  rename(property_id = Property_ID, coast_dist = NEAR_DIST) %>% 
  select(property_id, coast_dist)

coast_near %>% 
  select(coast_dist) %>% 
  summarytools::descr(stats = c("mean", "med", "min", "max")) 

SA1_2016_join_new <- readRDS("./data/airdna/clean/SA1_2016_join_new.Rds") %>% 
  dplyr::select(property_id, SA2_5DIG16)

coast_near <- left_join(coast_near, SA1_2016_join_new) %>% 
  group_by(SA2_5DIG16) %>% 
  summarise(cost_mean = mean(coast_dist),
            cost_median = median(coast_dist))

coast_near %>% 
  select(cost_mean, cost_median) %>% 
  summarytools::descr(stats = c("mean", "med", "min", "max")) 

SA2 <- left_join(SA2, coast_near)

rm(coast_near, SA1_2016_join_new)
```

```{r}
tm_shape(SA2) +
  tm_polygons(col = "cost_median", n = 5, alpha = 0.5, lwd = 0.5)
```

## Tourist accomodation

ABS dataset '8635.0 - Tourist Accommodation, Australia, 2015-16' [dataset](http://www.abs.gov.au/AUSSTATS/abs@.nsf/Lookup/8635.0Main+Features12015-16?OpenDocument) could be used to provide information on supply and deman of accomodation on SA2 level. Several indicators are available on **monthly basis for July 2015 - June 2016 period**:

Establishments 
Rooms 
Bed spaces 
Room nights occupied 
Room nights available 
Room occupancy rate
Guest nights occupied 
Guest nights available 
Bed occupancy rate
Takings from accommodation 
Average takings per room night occupied
Average takings per room night available

See external description for an example of 'Guest Nights Occupied' calculations.

```{r}
saveRDS(airbnb_sa2, file = "./data/airdna/clean/airbnb_sa2.rds")
# write_csv(airbnb_sa2, path = "./data/airdna/clean/airbnb_sa2.csv", 
#           na = "NA", append = FALSE, col_names = TRUE)
```

<!-- ------------------------------------------------------------ --> 
<!-- ------------------------------------------------------------ --> 

# Distribution of outcome

As continuous

```{r}
p_load(fitdistrplus)

plotdist(airbnb_sa2$cumulative, histo = TRUE, demp = TRUE)
descdist(airbnb_sa2$cumulative, boot = 1000)
```

As discreet

```{r}
airbnb_sa2_poi <- fitdist(airbnb_sa2$cumulative, "pois")
airbnb_sa2_nb <- fitdist(airbnb_sa2$cumulative, "nbinom")

par(mfrow = c(1,2))
denscomp(list(airbnb_sa2_poi, airbnb_sa2_nb), legendtext = c("Poisson", "negative binomial"), fitlty = 1)
cdfcomp(list(airbnb_sa2_poi, airbnb_sa2_nb), legendtext = c("Poisson", "negative binomial"), fitlty = 1)

# gofstat(list(airbnb_sa2_poi, airbnb_sa2_nb), fitnames = c("Poisson", "negative binomial"))
rm(airbnb_sa2_poi, airbnb_sa2_nb)
```


As continuous

```{r}
plotdist(airbnb_sa2$revenue, histo = TRUE, demp = TRUE)
descdist(airbnb_sa2$revenue, boot = 1000)
```

As discreet

```{r}
airbnb_sa2_poi <- fitdist(airbnb_sa2$revenue, "pois")
airbnb_sa2_nb <- fitdist(airbnb_sa2$revenue, "nbinom")

par(mfrow = c(1,2))
denscomp(list(airbnb_sa2_poi, airbnb_sa2_nb), legendtext = c("Poisson", "negative binomial"), fitlty = 1)
cdfcomp(list(airbnb_sa2_poi, airbnb_sa2_nb), legendtext = c("Poisson", "negative binomial"), fitlty = 1)

# gofstat(list(airbnb_sa2_poi, airbnb_sa2_nb), fitnames = c("Poisson", "negative binomial"))
rm(airbnb_sa2_poi, airbnb_sa2_nb)
```


```{r message=FALSE, warning=FALSE, include=FALSE}
dev.off()
p_unload(fitdistrplus)
```

<!-- ------------------------------------------------------------ --> 
<!-- ------------------------------------------------------------ --> 

# Session info

```{r}
sessionInfo()
```

